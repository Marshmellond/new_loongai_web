<script setup lang="ts">
import Icon from "@ant-design/icons-vue";
import {useCounterStore} from '@/stores/counter'
import {ref} from "vue";
import {Panel, VueFlow, useVueFlow} from '@vue-flow/core'


const counter = useCounterStore()


const add_ai_node = () => {
  const newNode = {
    id: `ai_${Date.now().toString()}`,
    data: {
      edit_mod: [
        "openai",
        0
      ],
      edit_mod_view: "gpt-3.5-turbo",
      edit_mod_img: "http://127.0.0.1:8000/img/head?path=api&name=openai.png",
      app_mod: [
        "无"
      ],
      app_mod_view: "无",
      app_mod_img: "http://127.0.0.1:8000/img/head?path=model&name=null.png",
      system: "",
      input: "",
      print: `AI回复内容${counter.flow_data.nodes.length + 1}`,
      order: counter.flow_data.nodes.length + 1,
      isSelected: false,
    },
    type: 'ai', // 节点类型
    position: {x: 900, y: 500},
  };
  counter.flow_data.nodes.push(newNode);
}
const add_reply_node = () => {
  const newNode = {
    id: `reply_${Date.now().toString()}`,
    data: {
      label: '',
      order: counter.flow_data.nodes.length + 1,
      isSelected: false,
    },
    type: 'reply', // 节点类型
    position: {x: 1200, y: 500},
  };
  counter.flow_data.nodes.push(newNode);
}
const add_end_node = () => {
  const newNode = {
    id: `end_${Date.now().toString()}`,
    data: {
      variable_print: [],
      variable_content: [],
      order: counter.flow_data.nodes.length + 1,
      isSelected: false,
    },
    type: 'end', // 节点类型
    position: {x: 1500, y: 500},
  };
  counter.flow_data.nodes.push(newNode);
}
const add_if_node = () => {
  const newNode = {
    id: `if_${Date.now().toString()}`,
    data: {
      order: counter.flow_data.nodes.length + 1,
      isSelected: false,
    },
    type: 'if', // 节点类型
    position: {x: 900, y: 200},
  };
  counter.flow_data.nodes.push(newNode);
}
const add_var_node = () => {
  const newNode = {
    id: `var_${Date.now().toString()}`,
    data: {
      order: counter.flow_data.nodes.length + 1,
      isSelected: false,
    },
    type: 'var', // 节点类型
    position: {x: 1200, y: 200},
  };
  counter.flow_data.nodes.push(newNode);
}

const add_test_node = () => {
  console.log(counter.flow_data.edges)
}
</script>

<template>
  <div class="div1-head">
    <span style="font-size: 20px;margin-top: 1vh;margin-bottom: 1vh">工具面板</span>
  </div>
  <div class="div1-content">
    <span style="font-size: 16px;margin-top: 2vh">文本输出</span>
    <div class="div1-t1" @click="add_ai_node">
      <icon :style="{ color: '#000000'}">
        <template #component>
          <svg t="1719753473385" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
               p-id="7910" width="32" height="32">
            <path
                d="M511.500488 63.937561c33.104671 0 59.941463 26.836792 59.941463 59.941463 0 21.351149-11.163099 40.094845-27.971684 50.713476L543.469268 255.750244h287.719025c17.655758 0 31.96878 14.313022 31.96878 31.96878v575.438049c0 17.655758-14.313022 31.96878-31.96878 31.968781H191.812683c-17.655758 0-31.96878-14.313022-31.968781-31.968781V287.719024c0-17.655758 14.313022-31.96878 31.968781-31.96878h287.719024v-81.157744c-16.548839-10.452792-27.625022-28.781893-27.96469-49.721444L451.559024 123.879024c0-33.104671 26.836792-59.941463 59.941464-59.941463z m279.726829 263.742439H231.773659v495.516098h559.453658V327.68zM631.383415 672.343415a7.992195 7.992195 0 0 1 7.992195 7.992195v47.95317a7.992195 7.992195 0 0 1-7.992195 7.992196H391.617561a7.992195 7.992195 0 0 1-7.992195-7.992196v-47.95317a7.992195 7.992195 0 0 1 7.992195-7.992195h239.765854zM119.882927 399.609756a7.992195 7.992195 0 0 1 7.992195 7.992195v303.703415a7.992195 7.992195 0 0 1-7.992195 7.992195H71.929756a7.992195 7.992195 0 0 1-7.992195-7.992195V407.601951a7.992195 7.992195 0 0 1 7.992195-7.992195h47.953171z m831.188293 0a7.992195 7.992195 0 0 1 7.992195 7.992195v303.703415a7.992195 7.992195 0 0 1-7.992195 7.992195h-47.953171a7.992195 7.992195 0 0 1-7.992195-7.992195V407.601951a7.992195 7.992195 0 0 1 7.992195-7.992195h47.953171z m-607.40683 63.937561c30.897826 0 55.945366 25.04754 55.945366 55.945366s-25.04754 55.945366-55.945366 55.945366-55.945366-25.04754-55.945366-55.945366 25.04754-55.945366 55.945366-55.945366z m335.672195 0c30.897826 0 55.945366 25.04754 55.945366 55.945366s-25.04754 55.945366-55.945366 55.945366-55.945366-25.04754-55.945365-55.945366 25.04754-55.945366 55.945365-55.945366z"
                fill="#000000" p-id="7911"></path>
          </svg>
        </template>
      </icon>
      <span style="margin-left: 1vh">AI 对话</span>
    </div>
    <div class="div1-t1" @click="add_reply_node">
      <icon :style="{ color: '#000000'}">
        <template #component>
          <svg t="1719754481120" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
               p-id="16036" width="32" height="32">
            <path
                d="M125.16 182.048v523.376a68.272 68.272 0 0 0 68.264 68.264h320.536l129.272 129.296c5.672 5.64 16.864 11.128 24.152 9.608 2.32 0.768-2.568 0 0 0 12.576 0 26.664-12.544 26.664-25.128V773.696h136.536c37.68 0 68.264-30.56 68.264-68.264V182.048a68.272 68.272 0 0 0-68.264-68.264H193.424a68.272 68.272 0 0 0-68.264 68.264z m45.512 22.76a45.52 45.52 0 0 1 45.504-45.504h591.648a45.52 45.52 0 0 1 45.504 45.504v477.872a45.52 45.52 0 0 1-45.504 45.504H671.288a22.752 22.752 0 0 0-22.76 22.76v92.976l-108.48-108.504c-1.568-1.544-5.936-6.232-7.784-7.232H216.176a45.52 45.52 0 0 1-45.504-45.504V204.808z m159.28 182.048a45.504 45.504 0 1 0 45.512 45.504 45.496 45.496 0 0 0-45.512-45.504z m182.048 0a45.504 45.504 0 1 0-0.008 91.016A45.504 45.504 0 0 0 512 386.856z m182.04 0a45.504 45.504 0 1 0 0 91.024 45.504 45.504 0 0 0 0-91.024z"
                p-id="16037" fill="#000000"></path>
          </svg>
        </template>
      </icon>
      <span style="margin-left: 1vh">指定回复</span>
    </div>
    <div class="div1-t1" @click="add_end_node">
      <icon :style="{ color: '#000000'}">
        <template #component>
          <svg t="1719987499904" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
               p-id="6170" width="32" height="32">
            <path
                d="M718.9248 239.328c24.1984 17.2096 45.7152 36.704 64.5376 58.4896s34.9568 45.312 48.4032 70.592c13.4464 25.28 23.6608 52.032 30.6496 80.2688 6.9952 28.2368 10.4896 56.8704 10.4896 85.9136 0 50.016-9.5424 96.9408-28.64 140.7744-19.0848 43.8336-44.9088 82.016-77.4464 114.5536s-70.7264 58.3552-114.5536 77.4464C608.5376 886.4576 561.6192 896 511.5968 896c-49.472 0-96.1344-9.5424-139.9616-28.64-43.8336-19.0848-82.1504-44.9088-114.9568-77.4464s-58.6176-70.7264-77.4464-114.5536-28.2368-90.7584-28.2368-140.7744c0-28.4992 3.36-56.4736 10.0864-83.8976 6.72-27.4304 16.2624-53.5104 28.64-78.2464 12.3712-24.7424 27.6928-47.872 45.984-69.376 18.2848-21.5168 38.72-40.8768 61.3056-58.0928 11.84-8.6016 24.608-11.8272 38.3232-9.6768 13.7152 2.1504 24.8704 8.8768 33.472 20.1664 8.608 11.296 11.84 23.936 9.6896 37.92-2.1568 13.984-8.8768 25.28-20.1728 33.8816C324.4352 352 298.4896 382.3872 280.4736 418.4192c-18.016 36.032-27.0336 74.7584-27.0336 116.1664 0 35.5008 6.7264 68.9728 20.1728 100.4352 13.4464 31.4624 31.8656 58.8928 55.2576 82.2848 23.3984 23.392 50.8224 41.952 82.2848 55.6608 31.4624 13.7216 64.9344 20.576 100.4288 20.576 35.5008 0 68.9792-6.8544 100.4352-20.576 31.4624-13.7152 58.8928-32.2688 82.2848-55.6608 23.3984-23.392 41.952-50.8224 55.6608-82.2848 13.7216-31.4624 20.576-64.9344 20.576-100.4352 0-41.952-9.6832-81.6128-29.0432-118.9888s-46.5216-68.1664-81.472-92.3712c-11.84-8.064-18.9632-19.0912-21.3824-33.0688-2.4192-13.9904 0.4032-26.8928 8.4672-38.7264 8.0704-11.296 19.0912-18.1504 33.0752-20.5696C694.1824 228.4352 707.0912 231.264 718.9248 239.328L718.9248 239.328zM511.5968 537.0048c-13.984 0-25.9456-4.9728-35.8912-14.9184-9.952-9.952-14.9248-21.92-14.9248-35.904L460.7808 179.6288c0-13.984 4.9728-26.08 14.9248-36.3008S497.6128 128 511.5968 128c14.528 0 26.7648 5.1072 36.704 15.328 9.9584 10.2208 14.9312 22.3168 14.9312 36.3008l0 306.5536c0 13.984-4.9728 25.952-14.9312 35.904C538.3552 532.032 526.1184 537.0048 511.5968 537.0048L511.5968 537.0048zM511.5968 537.0048"
                fill="#000000" p-id="6171"></path>
          </svg>
        </template>
      </icon>
      <span style="margin-left: 1vh">结束</span>
    </div>
    <span style="font-size: 16px;margin-top: 2vh">工具</span>
    <div class="div1-t1" @click="add_if_node">
      <icon :style="{ color: '#000000'}">
        <template #component>
          <svg t="1719754129506" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
               p-id="10185" width="32" height="32">
            <path
                d="M779.733333 64c2.474667 0 4.864 0.768 6.826667 2.176l192.042667 137.173333a11.733333 11.733333 0 0 1 0 19.114667l-192 137.173333A11.733333 11.733333 0 0 1 768 350.08L767.957333 256h-237.994666c-6.826667 0-14.250667 7.466667-15.786667 18.901333l-0.298667 4.48v465.237334c0 12.373333 6.613333 21.248 13.482667 23.04l2.56 0.341333H768L768 674.346667a11.733333 11.733333 0 0 1 18.56-9.557334l192.042667 137.173334a11.733333 11.733333 0 0 1 0 19.114666l-192 137.173334a11.733333 11.733333 0 0 1-18.602667-9.557334L767.957333 853.333333h-237.994666c-54.912 0-97.877333-45.824-101.205334-101.717333l-0.213333-6.997333L428.501333 554.666667H291.370667a128.042667 128.042667 0 1 1 0-85.333334h137.130666V279.381333c0-56.618667 40.789333-104.704 94.677334-108.458666L529.92 170.666667h237.994667L768 75.733333c0-6.485333 5.248-11.733333 11.733333-11.733333z"
                fill="#000000" p-id="10186"></path>
          </svg>
        </template>
      </icon>
      <span style="margin-left: 1vh">判断器</span>
    </div>
    <div class="div1-t1" @click="add_var_node">
      <icon :style="{ color: '#000000'}">
        <template #component>
          <svg t="1719754261896" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
               p-id="14875" width="32" height="32">
            <path
                d="M869 112H155c-23.75 0-43 19.25-43 43v714c0 23.75 19.25 43 43 43h380c23.75 0 43-19.25 43-43s-19.25-43-43-43H198V198h628v628h-52c-23.75 0-43 19.25-43 43s19.25 43 43 43h95c23.75 0 43-19.25 43-43V155c0-23.75-19.25-43-43-43z"
                fill="#000000" p-id="14876"></path>
            <path
                d="M392.02 423c0-14.24 3.56-24.92 17.8-28.48 24.92-7.12 46.28-17.8 71.2-10.68 21.36 3.56 35.6 14.24 46.28 39.16 3.56 14.24 7.12 32.04 14.24 46.28 3.57-3.56 3.57-7.12 7.12-10.68 10.68-17.8 21.36-35.6 35.6-53.4 7.12-7.12 14.24-17.8 24.92-21.36 17.8-10.68 35.6-3.56 46.28 10.68s10.68 39.16-3.56 53.4c-14.24 17.8-32.04 21.36-49.84 17.8-3.56 0-10.68 0-14.24-3.56-7.12-3.56-14.24 0-21.36 7.12-3.56 7.12-10.68 14.24-14.24 21.36 0 3.56-3.56 7.12 0 10.68 7.12 28.48 14.24 56.96 21.36 81.88 7.12 24.92 24.92 35.6 49.84 28.48 7.12 0 10.68-3.56 17.8-3.56 0 17.8-3.56 21.36-17.8 28.48-21.36 10.68-46.28 17.8-71.2 14.24-21.36-3.56-39.16-14.24-46.28-39.16-3.56-14.24-7.12-32.04-14.24-49.84-3.56 3.56-3.56 7.12-7.12 10.68-10.68 17.8-21.36 39.16-35.6 56.96-7.12 10.68-17.8 17.8-28.48 21.36-17.8 7.12-35.6 0-42.72-14.24-7.12-14.24-7.12-39.16 3.56-53.4 14.24-17.8 32.04-21.36 53.4-17.8 3.56 0 7.12 0 10.68 3.56 10.68 7.12 17.8 3.56 21.36-7.12 3.56-7.12 10.68-14.24 14.24-21.36 3.56-3.56 3.56-7.12 0-10.68-7.12-24.92-10.68-49.84-17.8-71.2-10.68-32.04-24.92-42.72-53.4-32.04-7.12-3.56-10.68-3.56-17.8-3.56zM678.18 690c28.48-56.96 46.28-113.92 46.28-178s-10.68-121.04-39.16-178h42.72c3.56 0 3.56 3.56 3.56 3.56 35.6 60.52 49.84 128.16 42.72 202.91-7.12 53.4-28.48 99.68-53.4 142.41 0 3.56-3.56 3.56-7.12 3.56-10.68 3.56-21.36 3.56-35.6 3.56zM337.26 334c-53.4 121.04-49.84 238.52 10.68 356h-39.16s-3.56 0-3.56-3.56c-24.92-42.72-46.28-85.44-53.4-135.28-10.68-74.76 0-145.96 39.16-210.04 3.56-3.56 7.12-7.12 10.68-7.12h35.6zM610.43 868.99a42.99 42.99 0 0 0 21.5 37.24 43.006 43.006 0 0 0 43 0 43.012 43.012 0 0 0 21.5-37.24c0-15.37-8.19-29.56-21.5-37.24a43.006 43.006 0 0 0-43 0 42.99 42.99 0 0 0-21.5 37.24z m0 0"
                fill="#000000" p-id="14877"></path>
          </svg>
        </template>
      </icon>
      <span style="margin-left: 1vh">变量更新</span>
    </div>
    <div class="div1-t1" @click="add_test_node">
      <icon :style="{ color: '#000000'}">
        <template #component>
          <svg t="1719754261896" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
               p-id="14875" width="32" height="32">
            <path
                d="M869 112H155c-23.75 0-43 19.25-43 43v714c0 23.75 19.25 43 43 43h380c23.75 0 43-19.25 43-43s-19.25-43-43-43H198V198h628v628h-52c-23.75 0-43 19.25-43 43s19.25 43 43 43h95c23.75 0 43-19.25 43-43V155c0-23.75-19.25-43-43-43z"
                fill="#000000" p-id="14876"></path>
            <path
                d="M392.02 423c0-14.24 3.56-24.92 17.8-28.48 24.92-7.12 46.28-17.8 71.2-10.68 21.36 3.56 35.6 14.24 46.28 39.16 3.56 14.24 7.12 32.04 14.24 46.28 3.57-3.56 3.57-7.12 7.12-10.68 10.68-17.8 21.36-35.6 35.6-53.4 7.12-7.12 14.24-17.8 24.92-21.36 17.8-10.68 35.6-3.56 46.28 10.68s10.68 39.16-3.56 53.4c-14.24 17.8-32.04 21.36-49.84 17.8-3.56 0-10.68 0-14.24-3.56-7.12-3.56-14.24 0-21.36 7.12-3.56 7.12-10.68 14.24-14.24 21.36 0 3.56-3.56 7.12 0 10.68 7.12 28.48 14.24 56.96 21.36 81.88 7.12 24.92 24.92 35.6 49.84 28.48 7.12 0 10.68-3.56 17.8-3.56 0 17.8-3.56 21.36-17.8 28.48-21.36 10.68-46.28 17.8-71.2 14.24-21.36-3.56-39.16-14.24-46.28-39.16-3.56-14.24-7.12-32.04-14.24-49.84-3.56 3.56-3.56 7.12-7.12 10.68-10.68 17.8-21.36 39.16-35.6 56.96-7.12 10.68-17.8 17.8-28.48 21.36-17.8 7.12-35.6 0-42.72-14.24-7.12-14.24-7.12-39.16 3.56-53.4 14.24-17.8 32.04-21.36 53.4-17.8 3.56 0 7.12 0 10.68 3.56 10.68 7.12 17.8 3.56 21.36-7.12 3.56-7.12 10.68-14.24 14.24-21.36 3.56-3.56 3.56-7.12 0-10.68-7.12-24.92-10.68-49.84-17.8-71.2-10.68-32.04-24.92-42.72-53.4-32.04-7.12-3.56-10.68-3.56-17.8-3.56zM678.18 690c28.48-56.96 46.28-113.92 46.28-178s-10.68-121.04-39.16-178h42.72c3.56 0 3.56 3.56 3.56 3.56 35.6 60.52 49.84 128.16 42.72 202.91-7.12 53.4-28.48 99.68-53.4 142.41 0 3.56-3.56 3.56-7.12 3.56-10.68 3.56-21.36 3.56-35.6 3.56zM337.26 334c-53.4 121.04-49.84 238.52 10.68 356h-39.16s-3.56 0-3.56-3.56c-24.92-42.72-46.28-85.44-53.4-135.28-10.68-74.76 0-145.96 39.16-210.04 3.56-3.56 7.12-7.12 10.68-7.12h35.6zM610.43 868.99a42.99 42.99 0 0 0 21.5 37.24 43.006 43.006 0 0 0 43 0 43.012 43.012 0 0 0 21.5-37.24c0-15.37-8.19-29.56-21.5-37.24a43.006 43.006 0 0 0-43 0 42.99 42.99 0 0 0-21.5 37.24z m0 0"
                fill="#000000" p-id="14877"></path>
          </svg>
        </template>
      </icon>
      <span style="margin-left: 1vh">测试</span>
    </div>
  </div>
</template>

<style scoped lang="less">
.div1-head {
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid @theme-border-color;
}

.div1-content {
  display: flex;
  flex-direction: column;
  padding: 0.01vh 1vh 1vh 1vh;

  .div1-t1 {
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: 1vh;
    border-radius: 5px;
    margin-top: 1vh;
    cursor: pointer;
    user-select: none;

    &:hover {
      background: #f2f4f6;
    }
  }
}
</style>